function getMeta(){const e=[...document.querySelectorAll([...arguments].map((e=>`meta[name="${e}"], meta[property="${e}"]`)).join(", "))].at(-1);if(!e)return null;const t=e.value||e.content;return String(t).trim().substr(0,1e4)}function getJsonLd(){let e={};try{for(const t of[...document.querySelectorAll('script[type="application/ld+json"]')]){const r=JSON.parse(t.innerText)||{};if("string"==typeof r["@context"]&&r["@context"].includes("schema.org")&&(!r.url||similarURL(r.url))){if(r.name||r.headline){e=r;break}if(r["@graph"]&&(e=r["@graph"].find((e=>similarURL(e.url))),Object.keys(e).length))break}}}catch(e){console.log(e)}return Array.isArray(e.image)&&e.image.length?e.image={url:e.image[0]}:e.image&&e.image.url||Array.isArray(e.thumbnailUrl)&&e.thumbnailUrl.length&&(e.image={url:e.thumbnailUrl[0]}),e}function grabImages(){let e=[];try{for(const t of document.querySelectorAll("img")){if(e.length>=9)break;if(!t.complete||!t.src||t.src.includes(".svg"))continue;if(!t.offsetParent)continue;if(t.closest("header, footer, aside"))continue;const r=Math.min(t.naturalWidth,t.width),i=Math.min(t.naturalHeight,t.height);if(r>100&&i>100){let r;try{r=new URL(t.currentSrc||t.src,location.href).href}catch(e){}r&&e.push(r)}}}catch(e){console.log(e)}return e}function similarURL(e){if(!e)return!1;const{pathname:t,search:r}=new URL(e,location.href);return(!r||r==location.search)&&t==location.pathname}function htmlDecode(e){try{return(new DOMParser).parseFromString(e||"","text/html").documentElement.textContent}catch(t){return t.error(t),e}}function getItem(){let e={link:location.href};const t=getMeta("twitter:url","og:url"),r=getJsonLd();if(e="/"==location.pathname||similarURL(t)||!window.history.state?{...e,title:getMeta("twitter:title","og:title")||getMeta("title")||document.title,excerpt:getMeta("twitter:description","og:description")||getMeta("description"),cover:getMeta("twitter:image","twitter:image:src","og:image","og:image:src")}:r.name||r.headline?{...e,title:htmlDecode(r.name||r.headline),excerpt:htmlDecode(r.description),cover:r.image&&r.image.url}:{...e,title:document.title.replace(new RegExp(`^${location.hostname.replace("www.","")}.`,"i"),"").trim()},e.title&&!/^home$/i.test(e.title)||(e.title=document.title),e.excerpt==e.title&&(e.excerpt=""),e.cover)try{e.cover=new URL(e.cover,location.href).href}catch(t){delete e.cover}let i=[...e.cover?[e.cover]:[],...grabImages()].filter(((e,t,r)=>r.indexOf(e)===t));i.length&&(e.media=i.map((e=>({type:"image",link:e}))),e.cover||(e.cover=i[0])),e.title&&e.title.length&&(e.title=e.title.substr(0,1e3)),e.excerpt&&e.excerpt.length&&(e.excerpt=e.excerpt.substr(0,1e4));try{const t=window.getSelection().getRangeAt(0).toString().trim();""!=t&&(e.highlights=[{_id:String((new Date).getTime()),text:t}])}catch(e){}for(const t in e)e[t]||delete e[t];return e}function parse(){try{return getItem()}catch(e){return console.log(e),{link:location.href,title:document.title}}}parse();