"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="6cdc8cd0-7345-5ada-9334-aca5ed99de1a")}catch(e){}}();

(() => {
var P=e=>{throw new Error("Unexpected value.")},C=()=>globalThis.crypto.getRandomValues(new Uint32Array(1))[0].toString(36),p=()=>{let e,t=new Promise(n=>{e=n});return{resolve:n=>e(n),promise:t}};var h=e=>{if(!e)return v();if(e.aborted)return Promise.resolve({type:"aborted"});let t=p(),r=()=>{t.resolve({type:"aborted"}),e.removeEventListener("abort",r)};return e.addEventListener("abort",r),t.promise},b=e=>!(typeof e!="string"||e.length===0),A=e=>e instanceof ArrayBuffer||e instanceof window.ArrayBuffer||e instanceof Uint8Array||e instanceof window.Uint8Array||e instanceof DataView||e instanceof window.DataView||e instanceof Array||e instanceof window.Array?Array.from(e instanceof ArrayBuffer||e instanceof window.ArrayBuffer?new Uint8Array(e):e):e,O=e=>new Promise(t=>{setTimeout(()=>t({type:"timeout"}),e)}),v=()=>new Promise(()=>{});function S(){if(typeof globalThis.exportFunction=="function")return globalThis.exportFunction}function I(){if(typeof globalThis.cloneInto=="function")return globalThis.cloneInto}function T(){if(window.wrappedJSObject)return window.wrappedJSObject}function q(e){let t=I();return t?t(e,window,{cloneFunctions:!0,wrapReflectors:!0}):e}function y(e){let t=I();return t?new window.Promise((r,n)=>{e.then(s=>{r(t(s,window,{cloneFunctions:!0,wrapReflectors:!0}))}).catch(s=>{n(s)})}):e}var w=class{constructor(t){this.credentials=new R(t.document,t.navigator?.credentials)}},R=class{constructor(t,r){if(!r){this.refs={exists:!1};return}this.refs={browserGetRef:r.get.bind(r),browserCreateRef:r.create.bind(r),document:t,exists:!0}}isSafari(){return!1}ensureFocus(){if(!this.refs.exists||this.refs.document.hasFocus())return;let t=this.refs.document.querySelectorAll('input[autocomplete*="webauthn"]');if(t){for(let n of t)if(n.focus(),document.hasFocus())return}let r=this.refs.document.querySelectorAll('input:not([autocomplete*="webauthn"])');if(r){for(let n of r)if(n.focus(),document.hasFocus())return}console.warn("could not ensure focus")}get(t){if(!this.refs.exists)throw new DOMException("The operation either timed out or was not allowed. See https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.","NotAllowedError");return this.isSafari()&&this.ensureFocus(),this.refs.browserGetRef(t)}create(t){if(!this.refs.exists)throw new DOMException("The operation either timed out or was not allowed. See https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.","NotAllowedError");return this.isSafari()&&this.ensureFocus(),this.refs.browserCreateRef(t)}};var d=class e{static{this.opSynType="op-window-syn"}static{this.opSynAckType="op-window-syn-ack"}static{this.opAbortType="op-window-abort"}static{this.opDirectRequestType="op-window-direct-request"}static{this.opDirectResponseType="op-window-direct-response"}static{this.NoReceivingEnd="no-receiving-end"}static{this.HandlerError="uncaught-handler-error"}constructor(t){this.routes=t,this.synRequests={},this.abortableRequests={},this.directRequests={},this.source=C(),this.debug=!1,this.log={error:(n,s)=>console.error(`PWM-${this.source}-${s}: ${n}`),debug:(n,s)=>{this.debug&&console.info(`PWM-${this.source}-${s}: ${n}`)}},window.addEventListener("message",n=>{if(!this.validateMessage(n.data))return;let o=n.data;if(o.source===this.source||o.destination&&o.destination!==this.source)return;let{type:i}=o,a=n.stopImmediatePropagation.bind(n);i===e.opSynType&&this.handleIncomingSyn(o,a),i===e.opSynAckType&&this.handleIncomingSynAck(o,a),i===e.opAbortType&&this.handleIncomingAbortRequest(o,a),i===e.opDirectRequestType&&this.handleIncomingDirectRequest(o,a),i===e.opDirectResponseType&&this.handleIncomingResponse(o,a)},!0)}async send(t,{body:r,signal:n}){let s=C(),o=await this.handleOutgoingSyn(s,t,n);if(o.type!=="ack")return o;let i=o.data;return(await this.handleOutgoingDirect(i.ackedById,s,t,r,n)).data}getRoutes(){return Object.keys(this.routes)}async handleOutgoingSyn(t,r,n){let s=h(n),o={msgId:t,source:this.source,type:e.opSynType,message:void 0,name:r};this.log.debug("starting request sequence",r);let i=p();this.synRequests[t]=i,window.postMessage(o),this.log.debug("starting ack race",r);let a=await Promise.race([i.promise,O(1e3),s]);if(a.type==="timeout")return this.log.debug("finished request sequence: ack timed out",r),delete this.synRequests[t],{type:e.NoReceivingEnd};if(a.type==="aborted"||n?.aborted)return this.log.debug("finished request sequence: aborted sync",r),delete this.synRequests[t],this.throwAbort(n);this.log.debug(`ack race won by: ${a.data.ackedById}`,r);let u=p();return this.directRequests[t]=u,a}handleIncomingSyn(t,r){if(!this.routes[t.name]){this.log.debug("received a request with no handler to call",t.name);return}r();let s={msgId:t.msgId,source:this.source,destination:t.source,name:t.name,type:e.opSynAckType,message:void 0};window.postMessage(s)}handleIncomingSynAck(t,r){if(typeof this.synRequests[t.msgId]>"u")return;r(),this.synRequests[t.msgId].resolve({type:"ack",data:{ackedById:t.source}}),delete this.synRequests[t.msgId]}async handleOutgoingDirect(t,r,n,s,o){let i=h(o),a=p();this.directRequests[r]=a;let u={msgId:r,source:this.source,destination:t,type:e.opDirectRequestType,message:s,name:n};this.log.debug(`sending direct request to: ${t}`,n),window.postMessage(u);let l=await Promise.race([a.promise,i]);if(delete this.directRequests[r],l.type==="aborted"){let g={...u,type:e.opAbortType};return g.reason=o?.reason,this.log.debug("notifying receiver to abort",n),window.postMessage(g),this.log.debug("finished request sequence: aborted",n),this.throwAbort(o)}return this.log.debug("finished request sequence: success",n),l}async handleIncomingDirectRequest(t,r){let n=this.routes[t.name];if(!n){this.log.error("received a request with no handler to call",t.name);return}r();let s=new AbortController;this.abortableRequests[t.msgId]=s;let o=h(s.signal),i;try{i=await Promise.race([n({body:t.message,signal:s.signal}),o])}catch(l){let g=l instanceof Error?l.message:"unknown";i={type:e.HandlerError,data:{reason:g}}}delete this.abortableRequests[t.msgId];let a=i;if(a&&a?.type==="aborted")return;let u={msgId:t.msgId,source:this.source,destination:t.source,name:t.name,type:e.opDirectResponseType,message:i};window.postMessage(u)}handleIncomingAbortRequest(t,r){if(typeof this.abortableRequests[t.msgId]>"u"){this.log.debug(`received abort ${t.msgId} for no active request - likely already completed`,t.name);return}r(),this.abortableRequests[t.msgId].abort(t.reason),delete this.abortableRequests[t.msgId]}handleIncomingResponse(t,r){if(typeof this.directRequests[t.msgId]>"u"){this.log.debug(`received response ${t.msgId} with no promise to resolve - likely already aborted`,t.name);return}r(),this.directRequests[t.msgId].resolve({type:"completed",data:t.message}),delete this.directRequests[t.msgId]}throwAbort(t){throw t?.reason?new DOMException(t?.reason,"AbortError"):new DOMException("signal is aborted without reason","AbortError")}validateMessage(t){let r="validate";if(typeof t!="object"||t===null)return this.log.debug("invalid message - not an object",r),!1;let n=t;return b(n.msgId)?b(n.source)?b(n.name)?n.type!==e.opSynType&&n.type!==e.opSynAckType&&n.type!==e.opAbortType&&n.type!==e.opDirectRequestType&&n.type!==e.opDirectResponseType?(this.log.debug("invalid message: type unsupported",r),!1):!0:(this.log.debug("invalid message - missing name",r),!1):(this.log.debug("invalid message - missing source",r),!1):(this.log.debug("invalid message - missing msgId",r),!1)}};var E=window.PublicKeyCredential?.isConditionalMediationAvailable?.bind(window.PublicKeyCredential),M=window.PublicKeyCredential?.isUserVerifyingPlatformAuthenticatorAvailable?.bind(window.PublicKeyCredential),c=new w(window),U,K=new Promise(e=>{let t=()=>{U=!0,e(void 0)};window.document.prerendering?document.addEventListener("prerenderingchange",t):t()}),H=async e=>{let t={...e};delete t?.signal,t.mediation==="conditional"&&t.publicKey?.timeout&&(t.publicKey.timeout=void 0);let r={type:"get-credential-request",data:JSON.stringify(t,(s,o)=>A(o))},n=await x.send("get-credential",{body:r});if(n.type===d.NoReceivingEnd||n.type===d.HandlerError)return c.credentials.get(e);if(n.type==="get-credential-error"){if(n.data.reason==="timeout")throw new DOMException("The operation either timed out or was not allowed. See https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.","NotAllowedError");if(t.mediation==="conditional"&&n.data.reason==="user-cancelled")return v();if(t.mediation==="conditional"&&n.data.reason==="fallback-requested"){let s={...e};return delete s.mediation,c.credentials.get(s)}return n.data.reason==="user-cancelled"?null:(n.data.reason==="fallback-requested"||n.data.reason==="internal-error"||n.data.reason==="invalid-request"||P(n.data.reason),c.credentials.get(e))}return F(n)},F=({data:e})=>{let t={clientDataJSON:new Uint8Array(e.response.clientDataJSON).buffer,authenticatorData:new Uint8Array(e.response.authenticatorData).buffer,signature:new Uint8Array(e.response.signature).buffer,userHandle:e.response.userHandle?new Uint8Array(e.response.userHandle).buffer:null};Object.setPrototypeOf(t,AuthenticatorAssertionResponse.prototype);let r={id:e.id,rawId:new Uint8Array(e.rawId).buffer,type:e.type,authenticatorAttachment:e.authenticatorAttachment??null,response:t,getClientExtensionResults:()=>q(e.clientExtensionResults??{})};return Object.setPrototypeOf(r,PublicKeyCredential.prototype),r},j=async e=>{let t={...e};delete t?.signal;let r={type:"create-credential-request",data:JSON.stringify(t,(s,o)=>A(o))},n=await x.send("create-credential",{body:r});if(n.type===d.NoReceivingEnd||n.type===d.HandlerError)return c.credentials.create(e);if(n.type==="create-credential-error"){if(n.data.reason==="timeout")throw new DOMException("The operation either timed out or was not allowed. See https://www.w3.org/TR/webauthn-2/#sctn-privacy-considerations-client.","NotAllowedError");if(n.data.reason==="duplicate")throw new DOMException("The user attempted to register an authenticator that contains one of the credentials already registered with the relying party.","InvalidStateError");return n.data.reason==="user-cancelled"?null:(n.data.reason==="fallback-requested"||n.data.reason==="internal-error"||n.data.reason==="invalid-request"||P(n.data.reason),c.credentials.create(e))}return G(n)},G=({data:e})=>{let t={attestationObject:new Uint8Array(e.response.attestationObject).buffer,clientDataJSON:new Uint8Array(e.response.clientDataJSON).buffer,getTransports:()=>e.response.transports??[],getAuthenticatorData:()=>new Uint8Array(e.response.authenticatorData??[]).buffer,getPublicKey:()=>e.response.publicKey?new Uint8Array(e.response.publicKey).buffer:null,getPublicKeyAlgorithm:()=>e.response.publicKeyAlgorithm};Object.setPrototypeOf(t,AuthenticatorAttestationResponse.prototype);let r={id:e.id,rawId:new Uint8Array(e.rawId).buffer,type:e.type,authenticatorAttachment:e.authenticatorAttachment??null,response:t,getClientExtensionResults:()=>q(e.clientExtensionResults??{})};return Object.setPrototypeOf(r,PublicKeyCredential.prototype),r},m,V=async()=>{let e={type:"should-intercept-webauthn-request",data:void 0},t=await x.send("should-intercept-webauthn",{body:e});return t.type===d.NoReceivingEnd||t.type===d.HandlerError||t.type==="should-intercept-webauthn-error"?!1:t.data},$=async e=>{typeof e.body.authenticatePasskeys<"u"&&(m=e.body.authenticatePasskeys)},x=new d({"update-settings":$}),f=async()=>(typeof U>"u"&&await K,typeof m>"u"&&(m=await V()),m);async function k(e){return await f()?j(e):c.credentials.create(e)}async function D(e){return await f()?H(e):c.credentials.get(e)}async function N(){return await f()?!0:E?E():!1}async function W(){return await f()?!0:M?M():!1}var B=()=>{let e=S();e?(e(t=>y(k(t)),window.navigator.credentials,{defineAs:"create"}),e(t=>y(D(t)),window.navigator.credentials,{defineAs:"get"}),e(()=>y(N()),window.PublicKeyCredential,{defineAs:"isConditionalMediationAvailable"}),e(()=>y(W()),window.PublicKeyCredential,{defineAs:"isUserVerifyingPlatformAuthenticatorAvailable"})):(window.navigator.credentials.create=k,window.navigator.credentials.get=D,window.PublicKeyCredential.isConditionalMediationAvailable=N,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable=W)},J=()=>{if(window.navigator.credentials.create.length>0&&window.navigator.credentials.get.length>0)return;let e=T();e&&e.navigator.credentials.create.length>0&&e.navigator.credentials.get.length>0||B()};function L(){window.navigator.credentials&&(f(),B(),setInterval(J,100))}L();
})();

//# debugId=6cdc8cd0-7345-5ada-9334-aca5ed99de1a
